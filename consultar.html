<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Juegos</title>
    <link rel="stylesheet" href="css/styles.css">

</head>
<body>

        <header>
        <nav>
            <ul>
                <a href="index.html">
                    <li>Ver</li>
                </a>
                <a href="consultar.html">
                    <li>Consultar id</li>
                </a>
                <a href="crear.html">
                    <li>Crear</li>
                </a>
                <a href="modificar.html">
                    <li>Modificar</li>
                </a>
                <a href="eliminar.html">
                    <li>Eliminar</li>
                </a>
            </ul>
        </nav>
    </header>


    <main>
        <h1>Consultar productos por id:</h1>

        <form id="getProducts-form">

            <label for="idProd">id Producto</label>

            <input type="number" name="id" id="idProd" required>

            <input type="submit" value="Consultar producto">

        </form>

        <hr>
        <div id="contenedor-productos">
            <ul id="listado-productos">
            
            </ul>
        </div>
    </main>


    <script>
        let getProducts_form = document.getElementById("getProducts-form");
        let listado_productos = document.getElementById("listado-productos") 
        
        getProducts_form.addEventListener("submit", async (event) =>{
           
            event.preventDefault();//previene el envio por defecto del formulario
            let formData = new FormData(event.target);        
            //convertir el objeto FormDara en un objeto normal jS para poder extraer la informacion
            let data = Object.fromEntries(formData.entries());
            let idProducto = data.id;

            try{

                let response = await fetch(`http://localhost:3000/productos/${idProducto}`);

                let datos = await response.json();
                
                console.log(response);
                console.log(datos);

                let producto = datos.payload[0];

                mostrarProducto(producto);
            
            } catch (error){
                console.error("Error", error)
            }


           // alert("Formulario no enviado");
        });

        function mostrarProducto(producto){
                let htmlProducto = `<li class="li-listados">
                    <img src="${producto.img_url}" alt="${producto.nombre}" class="img-listados">
                    <p Id: ${producto.id} / Nombre: ${producto.nombre} / > <strong>Precio: $${producto.precio} </strong></p>
                </li>`

                listado_productos.innerHTML = htmlProducto;
               
        }

    </script>
</body>
</html>